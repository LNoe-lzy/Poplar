响应式设计  
===  
# 响应式布局概念  
摘自百度百科：    
> 响应式布局是Ethan Marcotte在2010年5月份提出的一个概念，简而言之，就是一个网站能够兼容多个终端——而不是为每个终端做一个特定的版本。这个概念是为解决移动互联网浏览而诞生的。
响应式布局可以为不同终端的用户提供更加舒适的界面和更好的用户体验，而且随着目前大屏幕移动设备的普及，用“大势所趋”来形容也不为过。随着越来越多的设计师采用这个技术，我们不仅看到很多的创新，
还看到了一些成形的模式。  

![](/image/css10-1.png)  

# 像素与vieport    
可以看出在移动的时代，响应式设计就是为了更好地兼容移动平台和PC平台而准备的。那么为了更好的完成响应式设计，我们首先要思考这么一个问题：          
有时候我们在手机上打开PC上面的尺寸做好的网站，会发现根本手机上现实的就是PC的缩小版，东西都在只是字太小根本看不清。而加上  

```css  
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=0"/>  
```    
这样一行代码，就没有问题了，如下所示：  
![](/image/css10-2.png)  
这主要是和设备像素，视口等有关，现在我们先记住加上这样一行`meta`标签就好。视口这部分在移动端再说。  

# 响应式设计步骤  
## 设置meta标签    
如上面所提，大多数移动浏览器将html页面放大为宽的视图（viewport）以符合屏幕分辨率。
你可以使用视图的meta标签来进行重置。下面的视图标签告诉浏览器，使用设备的宽度作为视图宽度并禁止初始的缩放。
在`<head>`标签里加入上面的`<meta>`标签  

## 选择合适的布局方案  
响应式布局最终要的就是，当我们屏幕大小发生变化的时候，我们的页面同样会跟着变化(转换展现形式)等，保证页面的效果。例如派点互动网站：    
![](/image/css10-3.png)
这是一个典型的响应式网站，浏览器窗口变化的时候，我们会发现，网站的布局会随着浏览器的变化而变化。从而达到适应
屏幕显示的效果。这样在任何屏幕下，网站都能展现出一个良好的显示效果。为此我们需要一种布局方案，能够随着屏幕的改变而自动的改变布局效果。  
下面来考察一下各种布局方案。  
### 固定布局(px)   
在固定布局中，页面宽度会被指定为特定大小的像素，其中960px是使用最为广泛的宽度（因为960可以被3、4、5、6、8、10、12和15整除，所
以可以为网格布局提供多种可能）。固定布局是Web布局中最为常见的实现方式，因为固定布局会给人一种对页面拥有较多控制权的错觉。能确切地知道你的站点会以多宽来显示，这使得你能创建
出拥有大量图形的设计，而且即使在不同的屏幕上，它们也能看起来相当一致。然而，固定布局最大的问题在于，你的站点的像素宽度，布局一旦固定下来就无法改变了。所以并不适合适配
多种屏幕。  
### 流动布局(%)  
在流动布局中，度量的单位不再是像素，而是变成了百分比，这样可使页面具有
可变的特性。你可以设计一个占容器宽度60%的内容栏、一个占容器宽度30%的
边栏，以及一个占容器宽度10%的分隔区域。采用这种方法定义，意味着你不用
再去关心用户使用的到底是1024px宽的桌面浏览器，还是768px宽的平板电脑浏
览器，因为元素的宽度会根据浏览器窗口的宽度自动进行调整。  
流动布局的设计可以避免许多会在固定布局中遇到的问题，例如，在大多数情
况下，流动布局中都不会出现水平滚动条。由于站点可以根据浏览器窗口的宽
度来自动调节自身宽度，因此站点将可以充分利用并适应各种大小的可用空
间，从而也就避免了在使用大屏幕设备浏览固定布局时，人们所不愿见到的大
片空白出现。  
同时我们在做相应式查询的时候会发现流动布局会更容易设置断点。  
### 弹性布局  
弹性布局与流动布局类似，只是它们的度量单位不同——通常情况下，在
弹性布局中会以em来作为单位。1em相当于当前字体的大小，例如，如
果body 的字体大小是16px ， 那么此时1em就等于16px ， 同理2em等于
32px。  
弹性布局带来的另外一个好处是随着用户增大或者减小字体，使用弹性布局的
元素的宽度也会等比例地变化。从而达到内容不同布局不同。但是这个布局方案依然不能避免滚动条的出现。  
### flex布局  
利用css3中的弹性盒模型`display: flex;`我们能更好的做出自适应的网页布局状态，flex用法请参考[Flex 布局及示例](https://github.com/SIPC115/Poplar/blob/master/CSS/css4.md)    
### 混合布局  
综合上面的布局方式，一起来的就是混合布局了O(∩_∩)O哈哈~     

### 哪儿中布局最具有响应性呢  
大多数情况下，最佳答案是更具灵活性的那几种布局——流动布局、弹性布局或
者混合布局——因为相比固定布局，它们对未来更加友好。如果你使用流动布局，至少你已经得到了很大一部分。甚至没有媒介查询的
帮助，你的设计都能够在不同的视口之间作出调整，虽然会有一些不完美。当你开始强调媒体查询的作用时，你便很容易忽视掉另外一点：其实是弹性布
局或流动布局在发挥更主要的作用（参见第3章）。流动布局为你做的事情越
多，你需要创建的断点、写的CSS代码就越少。当你有了一个强大的流动布局的
时候，媒介查询就会弱化为一种调整设计的手段，而不必再去重新创建另外的
设计。     

## 字体大小  
在布局之后，我们还要考虑那些自适应的内容比如说：字体。要想让你的设计拥抱Web的流动性，那就意味着在你的设计中要能够灵活地改变
字体大小。你可以在Web上使用任意单位来设置字体大小，但主要的方法不外乎
三种：像素、em，rem还有百分比。这里我们主要用px，rem布局(em存在继承的问题，%不太好控制)。  
px得方案在移动端适配再说。这里介绍下rem：  
### rem  
rem单位，是一个相对值，跟HTML元素的font-size大小有关。1rem = 根源上上的font-size大小，这个等式恒成立
所以呢，我们用rem地字体进行布局的时候。当页面发生变化，我们只需要改变根元素上font-size的大小就可以了。
而不需要去挨个元素改变，方便css编写。同时rem布局也是移动端适配的最佳方案。    

## 响应式图片  
在布局，字体说完之后我们说说图片的选择。我么你知道我们在一个PC端网页上引入一个500kb的图片这似乎没有什么问题。
但是，当这个网页放到移动端上的时候，我们还需要引入这个500kb的网页么(文件体积大，消耗流量多，请求延时长)？我们知道移动端的带宽是很重要的，我们完全不需要这么大的
图片在移动端展示，是不是可以降低图片大小现实呢。为此我们需要一种响应式图片:  
### 处理原理  
浏览器获取用户终端的屏幕尺寸、分辨率逻辑处理后输出适应的图片，如屏幕分辨率320*480，那么我们匹配给它的是宽度应小于320px的图片。
如果终端屏幕的DPI(device pixels)DPI详解值很高，也就是高清屏，那么我们就得输出2倍分辨率的图形(宽:640px)；以保证在高清屏下图形的清晰度。关于DPI在
移动端会详细讨论  
### 解决方案  
其实W3C已经有一个用于响应式图形的草案：新定义标签`<picture>`，因为它还只是草案，
目前还没有支持的浏览器，期待在不久的未来我们能用上。虽然目前不支持，但我们还是来了解下。
`<picture>`是一个图形element，内容由多个源图组成，并由CSS Media Queries来适配出合理图形，代码规范如下：  

```html    
<picture width="500" height="500">
   <source media="(min-width: 640px)" srcset="large-1.jpg 1x, large-2.jpg 2x">
   <source media="(min-width: 320px)" srcset="med-1.jpg 1x, med-2.jpg 2x">
   <source srcset="small-1.jpg 1x, small-2.jpg 2x">
   <img src="small-1.jpg" alt="">
   <p>Accessible text</p>
   <!-- Fallback content-->
   <noscript>
      <img src="external/imgs/small.jpg" alt="Team photo">
   </noscript>
</picture>
```  
source: 一个图片源；media: 媒体查询，用于适配屏幕尺寸；srcset: 图片链接，1x适应普通屏，
2x适应高清屏；`<noscript/>`: 当浏览器不支持脚本时的一个替代方案；`<img/>`: 初始图片；另外还有一个无障碍文本，类似`<img/>`的alt属性。  

虽然目前这个方案并没有应用，但是原理还是值得我们思考的。我们也可以用同样的方式，图片交由js来动态加载不就好了，提供一种js的思路：  

```js  
if (window.matchMedia("(min-width: 37.5em)").matches) {
     //load in the images
    var lazy = Utils.q('[data-src]');
    for (var i = 0; i < lazy.length; i++) {
        var source = lazy[i].getAttribute('data-src');
        //create the image
        var img = new Image();
        img.src = source;
        //insert it inside of the link
        lazy[i].insertBefore(img, lazy[i].firstChild);
    };
}  
```  
利用`window.matchMedia`来匹配当前浏览器尺寸，从而加载不同的图片。  
有兴趣的可以参考 [picturefill](https://github.com/scottjehl/picturefill) 代码，实现js控制响应式图片。其原理就是JS获取Source的源以及CSS Media Queries规则，输出适应图片。  
当然，在未来的 CSS Image Level 4 中已经实现了响应式图片的原生语法：`image-set`。有兴趣的自己研究下吧 [CSS Image Values and Replaced Content Module Level 4](http://dev.w3.org/csswg/css4-images/)  

### 采用字体图标  
页面经常会有许多的图标，我们经常可以看见各种各样的图标。之前我们将这些图标做成一张雪碧图，引入。但是这样的图标，是不能适配的而且颜色不能动态更改。  
字体图标就很好的解决了这个问题，字体可以随意更改大小颜色。  

> 位图图片不能很好地进行缩放，当图片进行放大时会失真（即变模糊），当图片进行缩小时就会浪费掉像素。而且加载每一张图片都需要一次“http请求”，因此也拖慢了整个加载页面的时间。另外，要是没有图片编辑器（软件）的话就很难对图片进行编辑、处理等操作。  
字体就不会有以上这些问题，字体可以进行随意缩放并且每一个字符都不需要进行额外的“http请求”。当我们把字体当成文字用来写作的时候，往往没有想到的是，它们只是一种形状而已。   

使用示例如下：  

```css 
@font-face {
  font-family: "icon-phantom";
  src: url("../fonts/icomoon.eot");
  src: url("../fonts/icomoon.eot?#iefix") format("embedded-opentype"),
  url("../fonts/icomoon.woff") format("woff"),
  url("../fonts/icomoon.ttf") format("truetype"),
  url("../fonts/icomoon.svg") format("svg");
}  
.icon-search:after {
  content: '\f002';
}
```  
这里推荐一个字体图标库，很好很强大 [Iconfont-阿里巴巴矢量图标库](http://www.iconfont.cn/plus)  

## Media Queries  
有了布局，字体，图片的适配方案之后，我们适配的css代码将大幅度减少。但是并不能完成最后的网页适配效果，我们还必须告诉
网页在什么时候改变展示形式，什么时候改变布局方案等等。为此我们需要媒体查询。    
Media Queries，其作用就是允许添加表达式用以确定媒体的环境情况，以此来应用不同的样式表。换句话说，其允许我们在不改变内容的情况下，改变页面的布局以精确适应不同的设备。
那么，Media Queries是如何工作的？    
### link标签中引入
一种是直接在link中判断设备的尺寸，然后引用不同的css文件：   

```html   
<link rel="stylesheet" type="text/css" href="styleA.css" media="screen and (min-width: 400px)"> 
```  
意思是当屏幕的宽度大于等于400px的时候，应用styleA.css在media属性里：  

* screen 是媒体类型里的一种，CSS2.1定义了10种媒体类型  
* and 被称为关键字，其他关键字还包括 not(排除某种设备)，only(限定某种设备)  
* (min-width: 400px) 就是媒体特性，其被放置在一对圆括号中。  

举个栗子：  

```html  
<link rel="stylesheet" type="text/css" href="styleB.css"  media="screen and (min-width: 600px) and (max-width: 800px)">  
```  
意思是当屏幕的宽度大于600小于800时，应用styleB.css。这样当屏幕改变时，页面会引入不同的css完成对页面的重新布局。达到适配效果。  

### 直接写在样式表中  
```css  
@media screen and (max-width: 600px) { /*当屏幕尺寸小于600px时，应用下面的CSS样式*/
  .class {
    background: #ccc;
  }
}  
```  
写法是前面加@media，其它跟link里的media属性相同, 其实基本上就是样式覆盖~，判断设备，然后引用不同的样式文件覆盖。    
要注意的是由于网页会根据屏幕宽度调整布局，所以不能使用绝对宽度的布局，也不能使用具有绝对宽度的元素。这一条非常重要，否则会出现横向滚动条。  
常用于布局的CSS Media Queries有以下几种:  

* 设备类型(media type):  
    * all 所有设备 
    * screen 电脑显示器
    * print打印用纸或打印预览视图
    * handheld便携设备
    * tv电视机类型的设备
    * speech语意和音频盒成器
    * braille盲人用点字法触觉回馈设备
    * embossed盲文打印机
    * projection各种投影设备
    * tty使用固定密度字母栅格的媒介，比如电传打字机和终端    
* 设备特性(media feature):  
    * width浏览器宽度
    * height浏览器高度
    * device-width设备屏幕分辨率的宽度值
    * device-height设备屏幕分辨率的高度值
    * orientation浏览器窗口的方向纵向还是横向，当窗口的高度值大于等于宽度时该特性值为portrait，否则为landscape
    * aspect-ratio比例值，浏览器的纵横比
    * device-aspect-ratio比例值，屏幕的纵横比  

举几个例子：  

```css
/*当屏幕分辨率小与240px应用下面的值*/  
@media only screen and (max-device-width:240px){
	selector{ ... }
}   
/*当屏幕分辨率在240px ~ 320px之间用下面的值*/  
@media only screen and (min-device-width:240px) and (max-device-width:320px){
	selector{ ... }
} 
```  

更多使用方式，请参考[w3c菜鸟教程 @media](http://www.runoob.com/cssref/css3-pr-mediaquery.html)  

### 响应式断点设置  
断点的设置，主要还是要看适配设备的尺寸而定：  
![](/image/css10-4.png)    
传统的确定断点的方案是使用一些固定的宽度进行划分，如 320px(iPhone)，768px(iPad)，960px 或 1024px(传统 PC 浏览器)，这种方案的好处是很好照顾到了当前主流的设备，但是技术发展实现是太快了，各种不同分辨率的设备层出不穷，比如一些手机尺寸接近平板，一些平板尺寸比电脑更大等等，很难保证未来能很好的支持各种设备。另外一种确定断点的方法是根据内容进行设置断点以及设置多少个断点。随着各种尺寸设备的出现，断点命名采用更为通用的方式，而不是用设备来命名更为合适。说白了，您慢慢调整网页大小，如果发现有问题就设置断点。
对所有情况逐一适配就好(前提是，你已经充分了应用了自适应布局，这样断点数和css的代码才会尽可能的少，减少工作量)    
![](/image/css10-5.png)  

## 响应式框架  
现在有很多流行的响应式框架，辅助我们来做响应式布局，比如：bootstrap，amazeui等。  
他们都有一套自己的栅格系统来做响应式的布局：  
![](/image/css10-6.png)  
原理呢，就是我们上面讲的布局方式和媒体查询，查看css代码：  
![](/image/css10-7.png)  
有兴趣的可以自己实现以下栅格系统，还是很简单的。  

# 响应式布局优缺点  
响应式页面的优点：  

1. 跨平台： 在手机，pad，电脑上均有不俗的表现。
2. 节省人力开发成本：不再需要有人特地维护PC页面，移动页面。
3. 表现力一致：在不同的平台上看到的东西都是基本一致的，会让感觉体验良好。  

响应式布局缺点：   

1. 自由度太低，局限性较大：你需要考虑在手机，pad，PC上三种屏幕下的页面内元素的呈现，会导致有着非常大的局限，比如说我在PC上是横向滑动的通栏图，但是在手机和pad就是不用的。所以，你就只能用一张单一的图或者一组静态图来表达。
2. 页面会比较大，在当前国内渣渣2G，3G网络下打开速度会比较慢：由于响应式页面是同时下载多套CSS样式代码，可能在手机上就下载PC/pad的冗余代码，其实毫无意义，而且浪费了流量资源。
3. 对于非webkit内核的浏览器支持极差(IE6,7,8等就直接悲剧了)：对于非webkit内核的浏览器，比如说Windows Phone手机上用的IE浏览器，完全就悲剧了，彻底看不了。不过还好，现在的IOS，Android都是webkit内核，至少在80%以上的手机上可以有良好的呈现。


综上所述，如果你的网站设计的简洁，内容较少，那么用响应式的方案将是非常不错的选择。但是如果你的网站设计的复杂，展示内容相对较多，对性能又有
很高的要求，那么还是老老实实的PC出一套网站，移动端出一套网站吧。  

# 附录  
参考资料如下：  
[w3c Media Queries](https://www.w3.org/TR/css3-mediaqueries/)  
[CSS Image Values and Replaced Content Module Level 4](https://drafts.csswg.org/css-images-4/)  
[响应式web设计实践](http://item.jd.com/11186336.html)  
[响应式网页设计](https://isux.tencent.com/responsive-web-design.html)  
[为什么要用和如何使用字体图标](http://www.w3cplus.com/css3/icon-fonts.html)  


